inputs:

## collect linux system and services logs
#- type:  logs/journald
#  enabled: false
#  # include_matches:
#  # - syslog.identifier=test

# collect system metrics
- type: metrics/system/process
  enabled: true
  streams:
  - period: 60

- type: metrics/system/cpu
  enabled: true
  streams:
  - period: 10

#- type: audit/file_integrity
#  streams:
#  - paths:
#    - /bin
#    # - /sbin
#    # - /usr/bin
#    # - /usr/sbin
#    # - /usr/local/bin
#    # - /usr/local/sbin

# monitor local NAS
- type: monitor/icmp
  streams:
  - hosts: ["festplatte"]
    schedule: "@every 5s"

## monitor and analyzer DNS, HTTP and HTTPS traffic
- type: net/sniffer
  streams:
  - interface.device: [lo, enp39s0, wlo1]
    protocols:
    - type: icmp
    - type: dns
      ports: [53]
    - type: http
      ports: [80]
    - type: tls    # https
      ports: [443]
  - interface.device: [lo, enp39s0, wlo1]
    flows:
      timeout: 30s
      period: 10s

limits:
  # configure uptime monitors, concurrent network operations limits
  monitors: 20

logging.level: info
logging.selectors: ['*']

output.console.pretty: true
